C51 COMPILER V9.60.7.0   PWM                                                               09/08/2023 23:50:03 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE PWM
OBJECT MODULE PLACED IN .\Objects\PWM.obj
COMPILER INVOKED BY: D:\install\Keil\C51\BIN\C51.EXE PWM.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\
                    -PWM.lst) TABS(2) OBJECT(.\Objects\PWM.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "PWM.h"
   3          
   4          unsigned int m_ratio;
   5          unsigned char counter;
   6          
   7          void PWM_Init(unsigned int ratio)
   8          {
   9   1        m_ratio=ratio;
  10   1        //å¯¹å®šæ—¶å™¨è¿›è¡Œåˆå§‹åŒ–
  11   1        //1å¾®ç§’@11.0592MHz
  12   1        TMOD &= 0xF0;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  13   1        TMOD |= 0x01;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
  14   1        
  15   1        //ä»¥ä¸‹è®¾å®šä¸ºè¯¥å•ç‰‡æœºå®šæ—¶åˆå§‹å€¼æœ€å¤§è®¾ç½®é™åº¦ï¼Œè¶…è¿‡æ­¤å€¼ï¼Œå®šæ—¶å™¨ä¸­æ–­æ—¶é—´é”™è
             -¯¯
  16   1        TL0 = 0xFD;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  17   1        TH0 = 0xFF;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  18   1      
  19   1        TF0 = 0;        //æ¸…é™¤TF0æ ‡å¿—
  20   1        TR0 = 1;        //å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
  21   1        ET0 = 1;        //ä½¿èƒ½å®šæ—¶å™¨0ä¸­æ–­
  22   1        
  23   1        EA=1;           //ä½¿èƒ½æ€»ä¸­æ–­
  24   1      }
  25          
  26          void Timer0_Routine() interrupt 1
  27          {
  28   1        TL0 = 0xFD;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  29   1        TH0 = 0xFF;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
  30   1        
  31   1        counter++;
  32   1      
  33   1        port=!(counter>=m_ratio);
  34   1      
  35   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     59    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
